19/02/21 20:40:30 INFO SparkContext: Running Spark version 2.1.0
19/02/21 20:40:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
19/02/21 20:40:32 INFO SecurityManager: Changing view acls to: PETER
19/02/21 20:40:32 INFO SecurityManager: Changing modify acls to: PETER
19/02/21 20:40:32 INFO SecurityManager: Changing view acls groups to: 
19/02/21 20:40:32 INFO SecurityManager: Changing modify acls groups to: 
19/02/21 20:40:32 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(PETER); groups with view permissions: Set(); users  with modify permissions: Set(PETER); groups with modify permissions: Set()
19/02/21 20:40:33 INFO Utils: Successfully started service 'sparkDriver' on port 52261.
19/02/21 20:40:33 INFO SparkEnv: Registering MapOutputTracker
19/02/21 20:40:33 INFO SparkEnv: Registering BlockManagerMaster
19/02/21 20:40:33 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
19/02/21 20:40:33 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
19/02/21 20:40:33 INFO DiskBlockManager: Created local directory at /private/var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/blockmgr-dd6c37e0-bb2a-47f7-8aed-5f38fc12aa89
19/02/21 20:40:34 INFO MemoryStore: MemoryStore started with capacity 12.5 GB
19/02/21 20:40:34 INFO SparkEnv: Registering OutputCommitCoordinator
19/02/21 20:40:35 INFO Utils: Successfully started service 'SparkUI' on port 4040.
19/02/21 20:40:35 INFO SparkUI: Bound SparkUI to 127.0.0.1, and started at http://127.0.0.1:4040
19/02/21 20:40:35 INFO SparkContext: Added JAR file:/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.1-2.11.jar at spark://127.0.0.1:52261/jars/sparklyr-2.1-2.11.jar with timestamp 1550752835062
19/02/21 20:40:35 INFO Executor: Starting executor ID driver on host localhost
19/02/21 20:40:35 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 52262.
19/02/21 20:40:35 INFO NettyBlockTransferService: Server created on 127.0.0.1:52262
19/02/21 20:40:35 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
19/02/21 20:40:35 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 127.0.0.1, 52262, None)
19/02/21 20:40:35 INFO BlockManagerMasterEndpoint: Registering block manager 127.0.0.1:52262 with 12.5 GB RAM, BlockManagerId(driver, 127.0.0.1, 52262, None)
19/02/21 20:40:35 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 127.0.0.1, 52262, None)
19/02/21 20:40:35 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 127.0.0.1, 52262, None)
19/02/21 20:40:36 WARN SparkContext: Using an existing SparkContext; some configuration may not take effect.
19/02/21 20:40:36 INFO SharedState: Warehouse path is 'file:/Users/peter/Documents/Project/Notebook_with_R/R_for_Data_Science/spark-warehouse'.
19/02/21 20:40:37 INFO HiveUtils: Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
19/02/21 20:40:38 INFO HiveMetaStore: 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore
19/02/21 20:40:38 INFO ObjectStore: ObjectStore, initialize called
19/02/21 20:40:39 INFO Persistence: Property hive.metastore.integral.jdo.pushdown unknown - will be ignored
19/02/21 20:40:39 INFO Persistence: Property datanucleus.cache.level2 unknown - will be ignored
19/02/21 20:40:43 INFO ObjectStore: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
19/02/21 20:40:44 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
19/02/21 20:40:44 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
19/02/21 20:40:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
19/02/21 20:40:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
19/02/21 20:40:45 INFO MetaStoreDirectSql: Using direct SQL, underlying DB is DERBY
19/02/21 20:40:45 INFO ObjectStore: Initialized ObjectStore
19/02/21 20:40:45 WARN ObjectStore: Version information not found in metastore. hive.metastore.schema.verification is not enabled so recording the schema version 1.2.0
19/02/21 20:40:46 WARN ObjectStore: Failed to get database default, returning NoSuchObjectException
19/02/21 20:40:47 INFO HiveMetaStore: Added admin role in metastore
19/02/21 20:40:47 INFO HiveMetaStore: Added public role in metastore
19/02/21 20:40:47 INFO HiveMetaStore: No user is added in admin role, since config is empty
19/02/21 20:40:47 INFO HiveMetaStore: 0: get_all_databases
19/02/21 20:40:47 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_all_databases	
19/02/21 20:40:47 INFO HiveMetaStore: 0: get_functions: db=default pat=*
19/02/21 20:40:47 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_functions: db=default pat=*	
19/02/21 20:40:47 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MResourceUri" is tagged as "embedded-only" so does not have its own datastore table.
19/02/21 20:40:47 INFO SessionState: Created HDFS directory: /tmp/hive/PETER
19/02/21 20:40:47 INFO SessionState: Created local directory: /var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/PETER
19/02/21 20:40:47 INFO SessionState: Created local directory: /var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/10350dfc-4f1f-4c9d-ab0b-848869a45070_resources
19/02/21 20:40:47 INFO SessionState: Created HDFS directory: /tmp/hive/PETER/10350dfc-4f1f-4c9d-ab0b-848869a45070
19/02/21 20:40:47 INFO SessionState: Created local directory: /var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/PETER/10350dfc-4f1f-4c9d-ab0b-848869a45070
19/02/21 20:40:47 INFO SessionState: Created HDFS directory: /tmp/hive/PETER/10350dfc-4f1f-4c9d-ab0b-848869a45070/_tmp_space.db
19/02/21 20:40:47 INFO HiveClientImpl: Warehouse location for Hive client (version 1.2.1) is file:/Users/peter/Documents/Project/Notebook_with_R/R_for_Data_Science/spark-warehouse
19/02/21 20:40:48 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:40:48 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:40:48 INFO HiveMetaStore: 0: get_database: global_temp
19/02/21 20:40:48 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: global_temp	
19/02/21 20:40:48 WARN ObjectStore: Failed to get database global_temp, returning NoSuchObjectException
19/02/21 20:40:49 INFO SparkSqlParser: Parsing command: SHOW TABLES
19/02/21 20:40:56 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:40:56 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:40:56 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:40:56 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:40:56 INFO HiveMetaStore: 0: get_tables: db=default pat=*
19/02/21 20:40:56 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_tables: db=default pat=*	
19/02/21 20:40:58 INFO CodeGenerator: Code generated in 733.075403 ms
19/02/21 20:40:58 INFO SparkContext: Starting job: collect at utils.scala:44
19/02/21 20:40:58 INFO DAGScheduler: Got job 0 (collect at utils.scala:44) with 1 output partitions
19/02/21 20:40:58 INFO DAGScheduler: Final stage: ResultStage 0 (collect at utils.scala:44)
19/02/21 20:40:58 INFO DAGScheduler: Parents of final stage: List()
19/02/21 20:40:58 INFO DAGScheduler: Missing parents: List()
19/02/21 20:40:58 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[5] at map at utils.scala:41), which has no missing parents
19/02/21 20:40:59 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 8.7 KB, free 12.5 GB)
19/02/21 20:40:59 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 4.6 KB, free 12.5 GB)
19/02/21 20:40:59 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 127.0.0.1:52262 (size: 4.6 KB, free: 12.5 GB)
19/02/21 20:40:59 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:996
19/02/21 20:40:59 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[5] at map at utils.scala:41)
19/02/21 20:40:59 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks
19/02/21 20:40:59 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 6041 bytes)
19/02/21 20:40:59 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
19/02/21 20:40:59 INFO Executor: Fetching spark://127.0.0.1:52261/jars/sparklyr-2.1-2.11.jar with timestamp 1550752835062
19/02/21 20:40:59 INFO TransportClientFactory: Successfully created connection to /127.0.0.1:52261 after 35 ms (0 ms spent in bootstraps)
19/02/21 20:40:59 INFO Utils: Fetching spark://127.0.0.1:52261/jars/sparklyr-2.1-2.11.jar to /private/var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/spark-8c7e1706-8da4-4eab-85f4-fcbce32ea99f/userFiles-b247e805-a5ff-41df-bdeb-fc1fb5a8be56/fetchFileTemp9127763180635171208.tmp
19/02/21 20:40:59 INFO Executor: Adding file:/private/var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/spark-8c7e1706-8da4-4eab-85f4-fcbce32ea99f/userFiles-b247e805-a5ff-41df-bdeb-fc1fb5a8be56/sparklyr-2.1-2.11.jar to class loader
19/02/21 20:40:59 INFO CodeGenerator: Code generated in 19.244532 ms
19/02/21 20:40:59 INFO CodeGenerator: Code generated in 20.82168 ms
19/02/21 20:40:59 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1231 bytes result sent to driver
19/02/21 20:40:59 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 579 ms on localhost (executor driver) (1/1)
19/02/21 20:40:59 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
19/02/21 20:40:59 INFO DAGScheduler: ResultStage 0 (collect at utils.scala:44) finished in 0.645 s
19/02/21 20:40:59 INFO DAGScheduler: Job 0 finished: collect at utils.scala:44, took 1.343181 s
19/02/21 20:41:00 WARN DataSource: Error while looking for metadata directory.
19/02/21 20:41:00 INFO ContextCleaner: Cleaned accumulator 0
19/02/21 20:41:00 INFO ContextCleaner: Cleaned accumulator 1
19/02/21 20:41:00 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 127.0.0.1:52262 in memory (size: 4.6 KB, free: 12.5 GB)
19/02/21 20:41:00 INFO SparkSqlParser: Parsing command: SHOW TABLES
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_tables: db=default pat=*
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_tables: db=default pat=*	
19/02/21 20:41:00 INFO SparkContext: Starting job: collect at utils.scala:44
19/02/21 20:41:00 INFO DAGScheduler: Got job 1 (collect at utils.scala:44) with 1 output partitions
19/02/21 20:41:00 INFO DAGScheduler: Final stage: ResultStage 1 (collect at utils.scala:44)
19/02/21 20:41:00 INFO DAGScheduler: Parents of final stage: List()
19/02/21 20:41:00 INFO DAGScheduler: Missing parents: List()
19/02/21 20:41:00 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[11] at map at utils.scala:41), which has no missing parents
19/02/21 20:41:00 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 8.7 KB, free 12.5 GB)
19/02/21 20:41:00 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 4.6 KB, free 12.5 GB)
19/02/21 20:41:00 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 127.0.0.1:52262 (size: 4.6 KB, free: 12.5 GB)
19/02/21 20:41:00 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:996
19/02/21 20:41:00 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[11] at map at utils.scala:41)
19/02/21 20:41:00 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks
19/02/21 20:41:00 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, PROCESS_LOCAL, 6042 bytes)
19/02/21 20:41:00 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
19/02/21 20:41:00 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1231 bytes result sent to driver
19/02/21 20:41:00 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 16 ms on localhost (executor driver) (1/1)
19/02/21 20:41:00 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
19/02/21 20:41:00 INFO DAGScheduler: ResultStage 1 (collect at utils.scala:44) finished in 0.017 s
19/02/21 20:41:00 INFO DAGScheduler: Job 1 finished: collect at utils.scala:44, took 0.028894 s
19/02/21 20:41:00 WARN DataSource: Error while looking for metadata directory.
19/02/21 20:41:00 INFO SparkSqlParser: Parsing command: SHOW TABLES
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:00 INFO HiveMetaStore: 0: get_tables: db=default pat=*
19/02/21 20:41:00 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_tables: db=default pat=*	
19/02/21 20:41:00 INFO SparkContext: Starting job: collect at utils.scala:44
19/02/21 20:41:00 INFO DAGScheduler: Got job 2 (collect at utils.scala:44) with 1 output partitions
19/02/21 20:41:00 INFO DAGScheduler: Final stage: ResultStage 2 (collect at utils.scala:44)
19/02/21 20:41:00 INFO DAGScheduler: Parents of final stage: List()
19/02/21 20:41:00 INFO DAGScheduler: Missing parents: List()
19/02/21 20:41:00 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[17] at map at utils.scala:41), which has no missing parents
19/02/21 20:41:00 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 8.7 KB, free 12.5 GB)
19/02/21 20:41:00 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 4.6 KB, free 12.5 GB)
19/02/21 20:41:00 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 127.0.0.1:52262 (size: 4.6 KB, free: 12.5 GB)
19/02/21 20:41:00 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:996
19/02/21 20:41:00 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[17] at map at utils.scala:41)
19/02/21 20:41:00 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks
19/02/21 20:41:00 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, PROCESS_LOCAL, 6042 bytes)
19/02/21 20:41:00 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
19/02/21 20:41:01 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 1231 bytes result sent to driver
19/02/21 20:41:01 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 2) in 14 ms on localhost (executor driver) (1/1)
19/02/21 20:41:01 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
19/02/21 20:41:01 INFO DAGScheduler: ResultStage 2 (collect at utils.scala:44) finished in 0.015 s
19/02/21 20:41:01 INFO DAGScheduler: Job 2 finished: collect at utils.scala:44, took 0.030426 s
19/02/21 20:41:01 INFO SparkSqlParser: Parsing command: SHOW TABLES
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_tables: db=default pat=*
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_tables: db=default pat=*	
19/02/21 20:41:01 INFO SparkSqlParser: Parsing command: SHOW TABLES
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_database: default
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_database: default	
19/02/21 20:41:01 INFO HiveMetaStore: 0: get_tables: db=default pat=*
19/02/21 20:41:01 INFO audit: ugi=PETER	ip=unknown-ip-addr	cmd=get_tables: db=default pat=*	
19/02/21 20:41:36 INFO SparkContext: Invoking stop() from shutdown hook
19/02/21 20:41:36 INFO SparkUI: Stopped Spark web UI at http://127.0.0.1:4040
19/02/21 20:41:36 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
19/02/21 20:41:36 INFO MemoryStore: MemoryStore cleared
19/02/21 20:41:36 INFO BlockManager: BlockManager stopped
19/02/21 20:41:36 INFO BlockManagerMaster: BlockManagerMaster stopped
19/02/21 20:41:36 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
19/02/21 20:41:36 INFO SparkContext: Successfully stopped SparkContext
19/02/21 20:41:36 INFO ShutdownHookManager: Shutdown hook called
19/02/21 20:41:36 INFO ShutdownHookManager: Deleting directory /private/var/folders/w3/ldztb0sj5j3b11ysmm1xyd500000gn/T/spark-8c7e1706-8da4-4eab-85f4-fcbce32ea99f
